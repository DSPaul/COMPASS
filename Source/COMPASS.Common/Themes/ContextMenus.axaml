<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:COMPASS.Common.Controls"
                    xmlns:vm ="clr-namespace:COMPASS.Common.ViewModels.Layouts"
                    xmlns:model ="clr-namespace:COMPASS.Common.Models"
                    xmlns:materialIcons="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia">
    <Design.PreviewWith>
        <StackPanel Orientation="Horizontal">
            <UserControl Content="{StaticResource CodexContextMenu}" Height="500" Width="250"/>
            <UserControl Content="{StaticResource MultiCodexContextMenu}" Height="500" Width="250"/>
        </StackPanel>
        
    </Design.PreviewWith>
    
    <ContextMenu x:Key="CodexContextMenu" x:DataType="vm:LayoutViewModel">
        <MenuItem Header="Open Locally" 
                  Command="{Binding CodexCommands.OpenCodexLocallyCommand}"
                  CommandParameter="{Binding SelectedCodex}"
                  Icon="{materialIcons:MaterialIconExt FileOutline}"/>
        
        <MenuItem Header="Open Online"
                  Command="{Binding CodexCommands.OpenCodexOnlineCommand}"
                  CommandParameter="{Binding SelectedCodex}"
                  Icon="{materialIcons:MaterialIconExt Web}"/>
        
        <Separator/>
        
        <MenuItem Header="Edit..." InputGesture="Ctrl + E"
                  Command="{Binding CodexCommands.EditCodexCommand}"
                  CommandParameter="{Binding SelectedCodex}"
                  Icon="{materialIcons:MaterialIconExt Edit}"/>
        
        <MenuItem IsChecked="{Binding SelectedCodex.Favorite}" InputGesture="Ctrl + F"
                  Command="{Binding CodexCommands.FavoriteCodexCommand}"
                  CommandParameter="{Binding SelectedCodex}">
            <MenuItem.Icon>
                <materialIcons:MaterialIcon Kind="Favorite" Foreground="{Binding $parent[MenuItem].Tag}"/>
            </MenuItem.Icon>
            <MenuItem.Theme>
                <ControlTheme TargetType="MenuItem" BasedOn="{StaticResource {x:Type MenuItem}}">
                    <Setter Property="Header" Value="Favorite"/>
                    <Setter Property="Tag" Value="{StaticResource TextColor}"/>
                    <Style Selector="^:checked">
                        <Setter Property="Header" Value="Unfavorite"/>
                        <Setter Property="Tag" Value="IndianRed"/>
                    </Style>
                </ControlTheme>
            </MenuItem.Theme>
        </MenuItem>
        
        <MenuItem InputGesture="Ctrl + I" 
                  IsChecked="{Binding CodexInfoVM.ShowCodexInfo}"
                  Command="{Binding CodexInfoVM.ToggleCodexInfoCommand}"
                  Icon="{materialIcons:MaterialIconExt BookInformationVariant}">
            <MenuItem.Theme>
                <ControlTheme TargetType="MenuItem" BasedOn="{StaticResource {x:Type MenuItem}}">
                    <Setter Property="Header" Value="Show info"></Setter>
                    <Style Selector="^:checked">
                        <Setter Property="Header" Value="Hide info"/>
                    </Style>
                </ControlTheme>
            </MenuItem.Theme>
        </MenuItem>
        
        <Separator/>
        
        <MenuItem Header="Renew MetaData"
                  Command="{Binding CodexCommands.GetMetaDataCommand}"
                  CommandParameter="{Binding SelectedCodex}"
                  Icon="{materialIcons:MaterialIconExt FileRefreshOutline}"/>
        
        <MenuItem Header="Renew Cover"
                  Command="{Binding CodexCommands.GetCoverCommand}"
                  CommandParameter="{Binding SelectedCodex}"
                  Icon="{materialIcons:MaterialIconExt ImageRefreshOutline}"/>
        
        <Separator/>
        
        <MenuItem Header="Show in Explorer"
                  Command="{Binding CodexCommands.ShowInExplorerCommand}"
                  CommandParameter="{Binding SelectedCodex}"
                  Icon="{materialIcons:MaterialIconExt FolderEyeOutline}"/>
        
        <MenuItem Header="Move to Collection"
                  ItemsSource="{Binding MVM.CollectionVM.CollectionDirectories}"
                  Icon="{materialIcons:MaterialIconExt FolderMoveOutline}">
            <MenuItem.Styles>
                <Style Selector="MenuItem MenuItem">
                    <Setter Property="Command" Value="{Binding $parent[MenuItem].((vm:LayoutViewModel)DataContext).CodexCommands.MoveToCollectionCommand}"/>
                    <Setter Property="CommandParameter">
                        <Setter.Value>
                            <MultiBinding Converter="{StaticResource MultiParamConverter}">
                                <Binding Path="$self.Header"/>
                                <Binding Path="$parent[MenuItem].((vm:LayoutViewModel)DataContext).SelectedCodex"/>
                            </MultiBinding>
                        </Setter.Value>
                    </Setter>
                </Style>
            </MenuItem.Styles>
        </MenuItem>
        
        <MenuItem Header="Remove" InputGesture="Delete"
                  ToolTip.Tip="Removes the item from COMPASS"
                  Command="{Binding CodexCommands.DeleteCodexCommand}"
                  CommandParameter="{Binding SelectedCodex}"
                  Icon="{materialIcons:MaterialIconExt Delete}"/>
        
        <MenuItem Header="Remove Forever" InputGesture="Alt+Delete"
                  Command="{Binding CodexCommands.BanishCodexCommand}"
                  CommandParameter="{Binding SelectedCodex}"
                  ToolTip.Tip="Removes the item from COMPASS and excludes it from future imports."
                  Icon="{materialIcons:MaterialIconExt DeleteForever}"/>
    </ContextMenu>

    <ContextMenu x:Key="MultiCodexContextMenu" x:DataType="vm:LayoutViewModel">
        <MenuItem Header="Open Selection" InputGesture="Enter"
                  Command="{Binding CodexCommands.OpenSelectedCodicesCommand}"
                  CommandParameter="{Binding SelectedCodices}" 
                  Icon="{materialIcons:MaterialIconExt FileMultipleOutline}" />
        
        <MenuItem Header="Bulk Edit Selection..." InputGesture="Ctrl + E"
                  Command="{Binding CodexCommands.EditCodicesCommand}"
                  CommandParameter="{Binding SelectedCodices}"
                  Icon="{materialIcons:MaterialIconExt Edit}" />
        
        <MenuItem Header="Favorite" InputGesture="Ctrl + F"
                  Command="{Binding CodexCommands.FavoriteCodicesCommand}"
                  CommandParameter="{Binding SelectedCodices}"
                  Icon="{materialIcons:MaterialIconExt Favorite}"/>
        
        <Separator />
        
        <MenuItem Header="Renew MetaData"
                  Command="{Binding CodexCommands.GetMetaDataBulkCommand}"
                  CommandParameter="{Binding SelectedCodices}"
                  Icon="{materialIcons:MaterialIconExt FileRefreshOutline}"/>
        
        <MenuItem Header="Renew Cover" 
                  Command="{Binding CodexCommands.GetCoverBulkCommand}"
                  CommandParameter="{Binding SelectedCodices}"
                  Icon="{materialIcons:MaterialIconExt ImageRefreshOutline}"/>
        
        <Separator />
        
        <MenuItem Header="Move to Collection"
                  ItemsSource="{Binding MVM.CollectionVM.CollectionDirectories}"
                  Icon="{materialIcons:MaterialIconExt FolderMoveOutline}">
            <MenuItem.Styles>
                <Style Selector="MenuItem MenuItem">
                    <Setter Property="Command" Value="{Binding $parent[MenuItem].((vm:LayoutViewModel)DataContext).CodexCommands.MoveToCollectionCommand}"/>
                    <Setter Property="CommandParameter">
                        <Setter.Value>
                            <MultiBinding Converter="{StaticResource MultiParamConverter}">
                                <Binding Path="$self.Header"/>
                                <Binding Path="$parent[MenuItem].((vm:LayoutViewModel)DataContext).SelectedCodices"/>
                            </MultiBinding>
                        </Setter.Value>
                    </Setter>
                </Style>
            </MenuItem.Styles>
        </MenuItem>
        
        <MenuItem Header="Remove" InputGesture="Delete"
                  ToolTip.Tip="Removes the items from COMPASS"
                  Command="{Binding CodexCommands.DeleteCodicesCommand}"
                  CommandParameter="{Binding SelectedCodices}"
                  Icon="{materialIcons:MaterialIconExt Delete}"/>
        
        <MenuItem Header="Remove Forever" InputGesture="Alt+Delete"
                  ToolTip.Tip="Removes the items from COMPASS and excludes it from future imports."
                  Command="{Binding CodexCommands.BanishCodicesCommand}"
                  CommandParameter="{Binding SelectedCodices}"
                  Icon="{materialIcons:MaterialIconExt DeleteForever}"/>
    </ContextMenu>
    <!--#endregion-->
</ResourceDictionary>
